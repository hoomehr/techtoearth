# Infrastructure Deployment Recommendations

## Executive Summary

This infrastructure plan was generated by Inframate based on analyzing your application's requirements and codebase structure.

### Recommended AWS Services:

VPC, Subnets, Internet Gateway, NAT Gateway, Route Tables, Security Groups, EC2, Auto Scaling Group, Application Load Balancer, MongoDB Atlas, S3, CloudFront, Route 53, CloudWatch, CloudTrail, IAM, KMS

## Detailed Recommendations

*   **VPC Configuration:** Create a VPC with public and private subnets.  Public subnets will host the ALB and NAT Gateway. Private subnets will host the EC2 instances running the React application.
*   **Security Groups:** Implement strict security group rules.  Allow inbound traffic to the ALB on ports 80 and 443.  Allow inbound traffic from the ALB to the EC2 instances on port 3000 (or the port the React application is configured to run on). Allow outbound traffic from the EC2 instances to MongoDB Atlas on port 27017, but only to the MongoDB Atlas IP ranges.  Allow outbound traffic from the NAT Gateway to the Internet.
*   **EC2 Auto Scaling Group (ASG):** Use an ASG to automatically scale the number of EC2 instances based on load. Configure the ASG with a health check against the React application to ensure instances are healthy. Configure scaling policies based on CPU utilization or other relevant metrics.
*   **Application Load Balancer (ALB):** Use an ALB to distribute traffic across the EC2 instances in the ASG. Configure the ALB to listen on ports 80 and 443.  Configure HTTPS listener with a valid SSL certificate (ACM). The ALB handles SSL termination.
*   **MongoDB Atlas:** Use MongoDB Atlas as a managed MongoDB service.  This provides high availability, backups, and automatic patching.  Choose an appropriate Atlas instance size based on anticipated data volume and performance requirements.
*   **S3 & CloudFront (Static Assets):**  Store static assets (images, CSS, JavaScript) in an S3 bucket.  Use CloudFront to serve these assets with low latency.  Configure CloudFront with HTTPS and configure the origin access identity (OAI) to only allow CloudFront to access the S3 bucket.
*   **Route 53 (DNS):** Use Route 53 to manage the application's DNS records.  Point the DNS record to the ALB.
*   **IAM Roles:** Create IAM roles with the least privilege necessary for each component.  The EC2 instances need an IAM role to access S3 for static assets and CloudWatch for logging.
*   **Monitoring & Logging:** Use CloudWatch to monitor the application's performance and health.  Configure CloudTrail to log all API calls made to AWS resources.  Implement application-level logging and send logs to CloudWatch Logs.
*   **HTTPS:** Enforce HTTPS for all traffic.  Use ACM to provision and manage SSL/TLS certificates.
*   **No Dockerfile/Kubernetes:** Since the directory structure doesn't indicate the presence of Dockerfiles or Kubernetes manifests, this configuration focuses on traditional EC2-based deployment. Dockerization and Kubernetes would add complexity, and given the constraints, this approach provides a good balance of features and ease of implementation.
*   **CI/CD:** The lack of CI files requires setting up a separate CI/CD pipeline. We will provide a solution to deploy using Terraform and GitHub Actions, but this would involve adding the necessary files for CI.
*   **Database Security:** Restrict access to MongoDB Atlas by whitelisting only the IP addresses of the VPC.
*   **Infrastructure as Code (IaC):**  Use Terraform to manage all infrastructure resources as code. This ensures consistency, repeatability, and version control.

## Estimated Monthly Costs

(This is a rough estimate, actual costs may vary. Using current AWS pricing as of November 2024, us-east-1 region.)
*   **MongoDB Atlas:** $50 - $500 (depending on instance size and features)
*   **EC2 (2 x t3.medium):** $30 - $60 (per month per instance, so $60 - $120)
*   **ALB:** $20 - $40 (depending on traffic)
*   **NAT Gateway:** $35 - $50 (depending on data processed)
*   **S3:** $1 - $5 (depending on storage and bandwidth)
*   **CloudFront:** $1 - $5 (depending on bandwidth)
*   **Route 53:** $0.50
*   **CloudWatch:** $5 - $15 (depending on logging volume)
*   **CloudTrail:** Free (for the first trail)
**Total Estimated Monthly Cost: $172.50 - $735.50**

*Note: These cost estimates are approximate and may vary based on usage patterns, region, and AWS pricing changes.*

## Deployment Instructions

1. **Prerequisites**:
   - AWS CLI configured with appropriate credentials
   - Terraform installed (v1.0.0+)

2. **Configuration**:
   - Update variables in `terraform.tfvars` to match your requirements
   - Review the Terraform files to ensure they meet your needs

3. **Deployment**:
   ```bash
   terraform init
   terraform plan
   terraform apply
   ```

4. **Cleanup**:
   ```bash
   terraform destroy
   ```

## Notes

- The Terraform files have been generated in the `terraform/` directory
- The configuration is based on the application requirements specified in `inframate.md`
- You may need to customize the Terraform files for your specific needs
